/*! For license information please see RosCard.js.LICENSE.txt */
(()=>{"use strict";var t={zh:{cardTitle:function(t){return"".concat(t||"未命名设备"," 卡片")},controlPanelTitle:"发送控制命令",sendButton:"发送",testButton:"测试",nameLabel:"设备名称: ",selectEntity:"请选择实体",selectCommand:"请选择命令",selectOption:"请选择选项",enterCommand:"请输入命令值...",clearButton:"清空",validEntity:"请选择有效实体",stateOn:"开",stateOff:"关",defaultIconPath:"/local/community/RosCard/icon_img/states_device_light_on_icon.png",entity:"实体",executionModes:{immediate:"立即执行",delayed:"延迟执行",popup:"弹窗询问"},independentDisplay:"是否独立显示",yes:"是",no:"否"},en:{cardTitle:function(t){return"".concat(t||"Unnamed Device"," Card")},controlPanelTitle:"Send Control Commands",sendButton:"Send",testButton:"Test",nameLabel:"Device Name: ",selectEntity:"Please select an entity",selectCommand:"Please select a command",selectOption:"Please select an option",enterCommand:"Enter command value...",clearButton:"Clear",validEntity:"Please select a valid entity",stateOn:"On",stateOff:"Off",defaultIconPath:"/local/community/RosCard/icon_img/states_device_light_on_icon.png",entity:"Entity",executionModes:{immediate:"Immediate",delayed:"Delayed",popup:"Popup Ask"},independentDisplay:"Show independently",yes:"Yes",no:"No"}};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(o())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&a(i,n.prototype),i}(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},i(t)}function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(o=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=function(r){function i(){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,n,r){return n=c(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,o()?Reflect.construct(n,r||[],c(t).constructor):n.apply(t,r))}(this,i)).firstRender=!0,n._language=navigator.language.startsWith("zh")?"zh":"en",n._translations=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(i,r),u=i,(l=[{key:"_createButton",value:function(t,e){var n=document.createElement("button");return n.innerText=t,n.style.margin="4px",n.style.padding="8px 12px",n.style.cursor="pointer",n.style.borderRadius="4px",n.onclick=e.bind(this),n}},{key:"_createIcon",value:function(t){var e=document.createElement("img");return e.src=t||this._translations[this._language].defaultIconPath,e.style.position="absolute",e.style.top="50px",e.style.right="30px",e.style.width="60px",e.style.height="60px",e}},{key:"_t",value:function(t){var e;return(null===(e=this._translations[this._language])||void 0===e?void 0:e[t])||""}}])&&n(u.prototype,l),Object.defineProperty(u,"prototype",{writable:!1}),u;var u,l}(i(HTMLElement));function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach(function(e){h(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function h(t,e,n){return(e=b(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,b(r.key),r)}}function b(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(g=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}var O=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=m(e),function(t,e){if(e&&("object"==l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,n||[],m(t).constructor):e.apply(t,n))}(this,e))._translations={zh:y(y({},t._translations.zh),{},{mediaCommands:[{label:"播放",value:"media_play"},{label:"暂停",value:"media_pause"},{label:"音量增加",value:"volume_up"},{label:"音量减少",value:"volume_down"},{label:"静音",value:"volume_mute_true"},{label:"取消静音",value:"volume_mute_false"}]}),en:y(y({},t._translations.en),{},{mediaCommands:[{label:"Play",value:"media_play"},{label:"Pause",value:"media_pause"},{label:"Volume Up",value:"volume_up"},{label:"Volume Down",value:"volume_down"},{label:"Mute",value:"volume_mute_true"},{label:"Unmute",value:"volume_mute_false"}]})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=y(y({},t),{},{tv_name:t.tv_name||("zh"===this._language?"未命名电视":"Unnamed TV"),entities:Array.isArray(null==t?void 0:t.entities)?s(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_tv.png",tv_type:t.tv_type||"android_tv"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.tv_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){"media_player"===e.type&&e.commands&&Object.entries(e.commands).forEach(function(r){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r,2),o=i[0],a=i[1],c=document.createElement("div");c.style.marginBottom="8px",c.innerHTML="<span>".concat(e.entity_id,": ").concat(o,"</span>");var u=t._createButton(t._translations[t._language].sendButton,function(){"volume_mute"===a?t._hass.callService(e.type,a,{entity_id:e.entity_id,is_volume_muted:o.includes("静音")||o.includes("Mute")}):t._hass.callService(e.type,a,{entity_id:e.entity_id})});c.appendChild(u),n.appendChild(c)})}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&v(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function j(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return E(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(E(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,E(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,E(f,"constructor",l),E(l,"constructor",u),u.displayName="GeneratorFunction",E(l,i,"GeneratorFunction"),E(f),E(f,i,"Generator"),E(f,r,function(){return this}),E(f,"toString",function(){return"[object Generator]"}),(j=function(){return{w:o,m:p}})()}function E(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}E=function(t,e,n,r){function o(e,n){E(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},E(t,e,n,r)}function S(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function P(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return C(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach(function(e){L(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I(r.key),r)}}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(k=function(){return!!t})()}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}function R(t,e){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R(t,e)}function L(t,e,n){return(e=I(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t){var e=function(t){if("object"!=w(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}var M=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=D(e),function(t,e){if(e&&("object"==w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,n||[],D(t).constructor):e.apply(t,n))}(this,e))._translations=x(x({},t._translations),{},{zh:x(x({},t._translations.zh),{},{mediaCommands:[{label:"播放",value:"media_play"},{label:"暂停",value:"media_pause"},{label:"音量增加",value:"volume_up"},{label:"音量减少",value:"volume_down"},{label:"静音",value:"volume_mute_true"},{label:"取消静音",value:"volume_mute_false"}]}),en:x(x({},t._translations.en),{},{mediaCommands:[{label:"Play",value:"media_play"},{label:"Pause",value:"media_pause"},{label:"Volume Up",value:"volume_up"},{label:"Volume Down",value:"volume_down"},{label:"Mute",value:"volume_mute_true"},{label:"Unmute",value:"volume_mute_false"}]})}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(e,t),n=e,r=[{key:"generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}},{key:"setConfig",value:function(t){var e=x({},t);e.id||(e.id=this.generateUUID()),this._config={type:e.type||"custom:aiks-tv-card",id:e.id,tv_type:e.tv_type||"android_tv",tv_name:e.tv_name||("zh"===this._language?"未命名电视":"Unnamed TV"),media_play_entity:e.media_play_entity||"",entities:Array.isArray(e.entities)?P(e.entities):[]},this.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},this._config)}})),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.style.marginBottom="10px",n.style.display="flex",n.style.alignItems="center";var r=document.createElement("span");r.innerText="zh"===this._language?"设备类型: ":"Device Type: ",r.style.width="100px",n.appendChild(r);var i=document.createElement("select");if(i.style.width="120px",[{value:"apple_tv",label:(this._language,"Apple TV")},{value:"android_tv",label:"zh"===this._language?"安卓电视":"Android TV"}].forEach(function(e){var n=document.createElement("option");n.value=e.value,n.text=e.label,t._config.tv_type===e.value&&(n.selected=!0),i.appendChild(n)}),i.addEventListener("change",function(){t._config.tv_type=i.value,"android_tv"===i.value&&(t._config.media_play_entity=""),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},t._config)}})),t.render()}),n.appendChild(i),e.appendChild(n),"apple_tv"===this._config.tv_type){var o=document.createElement("div");o.style.marginBottom="10px",o.style.display="flex",o.style.alignItems="center";var a=document.createElement("span");a.innerText="zh"===this._language?"播放实体: ":"Media Player: ",a.style.width="100px",o.appendChild(a);var c=document.createElement("select");c.style.width="200px",c.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(e){if(e.startsWith("media_player.")){var n,r=document.createElement("option");r.value=e,r.text=(null===(n=t._hass.states[e])||void 0===n||null===(n=n.attributes)||void 0===n?void 0:n.friendly_name)||e,e===t._config.media_play_entity&&(r.selected=!0),c.appendChild(r)}}),c.addEventListener("change",function(){t._config.media_play_entity=c.value,t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},t._config)}}))}),o.appendChild(c),e.appendChild(o)}var u=document.createElement("div");u.style.marginBottom="10px",u.style.display="flex",u.style.alignItems="center";var l=document.createElement("span");l.innerText=this._translations[this._language].nameLabel,l.style.width="100px",u.appendChild(l);var s=document.createElement("input");s.type="text",s.value=this._config.tv_name,s.style.width="200px",s.addEventListener("blur",function(){t._config.tv_name=s.value,t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},t._config)}}))}),u.appendChild(s),e.appendChild(u);var f=document.createElement("div");f.id="entityContainer",this._config.entities=["POWER","UP","DOWN","LEFT","RIGHT","ENTER","BACK","PLAY","PAUSE","VOLUME_UP","VOLUME_DOWN","MUTE","UN_MUTE","SETTINGS","HOME","MENU"].map(function(e,n){return t._config.entities[n]||{key:e,type:"",entity_id:"",value:""}}),this._config.entities.forEach(function(e,n){f.appendChild(t._createEntityRow(n,e,t._hass))}),e.appendChild(f),this.appendChild(e)}}},{key:"_showToast",value:function(t){try{this.dispatchEvent(new CustomEvent("show-toast",{detail:{message:t}}))}catch(e){console.warn(t)}}},{key:"_sendTest",value:function(t,e){var n,r=this._hass;if(r){var i=(null==t?void 0:t.entity_id)||"",o=i?i.split(".")[0]:(null==t?void 0:t.type)||"",a=(null!==(n=null!=e?e:null==t?void 0:t.value)&&void 0!==n?n:"").toString().trim();if(i&&o)if(a||"media_player"===o)if("remote"!==o)if("media_player"!==o)"select"!==o?this._showToast("不支持的类型：".concat(o)):r.callService("select","select_option",{entity_id:i,option:a});else if("volume_mute_true"===a||"volume_mute_false"===a)r.callService("media_player","volume_mute",{entity_id:i,is_volume_muted:a.endsWith("_true")});else if(a.startsWith("volume_set_")){var c=parseFloat(a.split("_").pop());Number.isNaN(c)?this._showToast("音量格式应为 volume_set_0.0~1.0"):r.callService("media_player","volume_set",{entity_id:i,volume_level:Math.max(0,Math.min(1,c))})}else r.callService("media_player",a||"media_play",{entity_id:i});else r.callService("remote","send_command",{entity_id:i,command:a});else this._showToast("请先填写命令/选项");else this._showToast("请先选择实体")}else this._showToast("hass 未就绪")}},{key:"_createEntityRow",value:function(t,n,r){var i=this,o=document.createElement("div");o.style.marginBottom="10px",o.style.display="flex",o.style.alignItems="center";var a=document.createElement("span");a.innerText="".concat(n.key,": "),a.style.width="100px",o.appendChild(a);var c=document.createElement("select");c.style.width="200px",c.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(r.states).forEach(function(t){if(t.startsWith("media_player.")||t.startsWith("remote.")||t.startsWith("select.")){var e,i=document.createElement("option");i.value=t,i.text=(null===(e=r.states[t])||void 0===e||null===(e=e.attributes)||void 0===e?void 0:e.friendly_name)||t,t===n.entity_id&&(i.selected=!0),c.appendChild(i)}}),o.appendChild(c);var u=document.createElement("div");u.style.marginLeft="10px",o.appendChild(u);var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i._config.entities.map(function(n,r){return r===t?x(x({},n),e):n});i._config=x(x({},i._config),{},{entities:n}),i.dispatchEvent(new CustomEvent("config-changed",{detail:{config:i._config},bubbles:!0,composed:!0}))},s=function(){var t;u.innerHTML="";var o=c.value,a=o?o.split(".")[0]:"",s=null;if("media_player"===a){var f=document.createElement("select");f.style.width="200px",f.innerHTML='<option value="">'.concat(i._translations[i._language].selectCommand,"</option>"),i._translations[i._language].mediaCommands.forEach(function(t){var e=document.createElement("option");e.value=t.value,e.text=t.label,t.value===n.value&&(e.selected=!0),f.appendChild(e)}),f.addEventListener("change",function(){return l({value:f.value})}),u.appendChild(f),s=f}else if("select"===a&&null!==(t=r.states[o])&&void 0!==t&&null!==(t=t.attributes)&&void 0!==t&&t.options){var p=document.createElement("select");p.style.width="200px",p.innerHTML='<option value="">'.concat(i._translations[i._language].selectOption,"</option>"),r.states[o].attributes.options.forEach(function(t){var e=document.createElement("option");e.value=t,e.text=t,t===n.value&&(e.selected=!0),p.appendChild(e)}),p.addEventListener("change",function(){return l({value:p.value})}),u.appendChild(p),s=p}else if("remote"===a){var d=document.createElement("input");if(d.type="text",n.value)d.value=n.value;else{var y,h=i._config.tv_type||"android_tv",v=(null===(y=e.REMOTE_DEFAULTS)||void 0===y||null===(y=y[h])||void 0===y?void 0:y[n.key])||"";d.value=v,l({value:v})}d.style.width="200px",d.placeholder=i._translations[i._language].enterCommand,d.addEventListener("input",function(){return l({value:d.value})}),u.appendChild(d);var b=i._createButton("zh"===i._language?"恢复默认":"Reset Default",function(){var t,r=i._config.tv_type||"android_tv",o=(null===(t=e.REMOTE_DEFAULTS)||void 0===t||null===(t=t[r])||void 0===t?void 0:t[n.key])||"";d.value=o,l({value:o})});u.appendChild(b);var g=i._createButton(i._translations[i._language].testButton,function(){return i._sendTest({key:n.key,type:a,entity_id:c.value,value:d.value},d.value)});u.appendChild(g)}else u.innerHTML="<span>".concat(i._translations[i._language].validEntity,"</span>");if(s){var m=i._createButton(i._translations[i._language].testButton,function(){return i._sendTest({key:n.key,type:a,entity_id:c.value,value:s.value},s.value)});u.appendChild(m)}};return c.addEventListener("change",function(){var t=c.value||"",r=t?t.split(".")[0]:"",o={entity_id:t,type:r};if("remote"===r){var a,u=i._config.tv_type||"android_tv";o.value=(null===(a=e.REMOTE_DEFAULTS)||void 0===a||null===(a=a[u])||void 0===a?void 0:a[n.key])||""}l(o),s()}),n.entity_id&&(c.value=n.entity_id,s()),o}}],i=[{key:"getConfigElement",value:(o=j().m(function t(){return j().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-tv-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){S(i,n,r,a,c,"next",t)}function c(t){S(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{type:"custom:aiks-tv-card",id:"",tv_type:"android_tv",tv_name:"zh"==(navigator.language.startsWith("zh")?"zh":"en")?"未命名电视":"Unnamed TV",media_play_entity:"",entities:[]}}}],r&&A(n.prototype,r),i&&A(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach(function(e){G(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function G(t,e,n){return(e=N(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,N(r.key),r)}}function N(t){var e=function(t){if("object"!=B(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(e)?e:e+""}function F(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(F=function(){return!!t})()}function $(t){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$(t)}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}L(M,"REMOTE_DEFAULTS",{android_tv:{POWER:"POWER",UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",ENTER:"ENTER",BACK:"BACK",PLAY:"PLAY",PAUSE:"PAUSE",VOLUME_UP:"VOLUME_UP",VOLUME_DOWN:"VOLUME_DOWN",MUTE:"MUTE",UN_MUTE:"UNMUTE",SETTINGS:"SETTINGS",HOME:"HOME",MENU:"MENU"},apple_tv:{POWER:"suspend",UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",ENTER:"select",BACK:"menu",PLAY:"play",PAUSE:"pause",VOLUME_UP:"volume_up",VOLUME_DOWN:"volume_down",MUTE:"mute",UN_MUTE:"",SETTINGS:"wakeup",HOME:"home",MENU:"menu"}});var q=function(t){function e(){var t,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=this,r=e,r=$(r),t=function(t,e){if(e&&("object"==B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(n,F()?Reflect.construct(r,i||[],$(n).constructor):r.apply(n,i)))._translations={zh:H(H({},t._translations.zh),{},{brightness:"亮度",color:"颜色",colorTemp:"色温",scene:"场景"}),en:H(H({},t._translations.en),{},{brightness:"Brightness",color:"Color",colorTemp:"Color Temp",scene:"Scene"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){var e;this._config=H(H({},t),{},{light_name:t.light_name||("zh"===this._language?"未命名灯光":"Unnamed Light"),entities:Array.isArray(null==t?void 0:t.entities)?(e=t.entities,function(t){if(Array.isArray(t))return U(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return U(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_light.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.light_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("light.")){var r,i=document.createElement("div");i.style.marginBottom="12px",i.style.padding="8px",i.style.border="1px solid #ddd",i.style.borderRadius="4px";var o=t._hass.states[e.entity_id],a="on"===(null==o?void 0:o.state)?t._translations[t._language].stateOn:t._translations[t._language].stateOff;i.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - ").concat(a,"</div>");var c=t._createButton("on"===(null==o?void 0:o.state)?"Off":"On",function(){var n="on"===(null==o?void 0:o.state)?"turn_off":"turn_on";t._hass.callService("light",n,{entity_id:e.entity_id})});if(i.appendChild(c),void 0!==(null==o||null===(r=o.attributes)||void 0===r?void 0:r.brightness)){var u=Math.round(o.attributes.brightness/255*100),l=document.createElement("input");l.type="range",l.min="0",l.max="100",l.value=u,l.style.width="100%",l.style.marginTop="8px",l.addEventListener("change",function(n){var r=Math.round(n.target.value/100*255);t._hass.callService("light","turn_on",{entity_id:e.entity_id,brightness:r})}),i.appendChild(l)}n.appendChild(i)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],r&&W(n.prototype,r),i&&W(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(u);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function K(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return J(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(J(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,J(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,J(f,"constructor",l),J(l,"constructor",u),u.displayName="GeneratorFunction",J(l,i,"GeneratorFunction"),J(f),J(f,i,"Generator"),J(f,r,function(){return this}),J(f,"toString",function(){return"[object Generator]"}),(K=function(){return{w:o,m:p}})()}function J(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}J=function(t,e,n,r){function o(e,n){J(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},J(t,e,n,r)}function Q(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function X(t){return function(t){if(Array.isArray(t))return tt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(t,e){if(t){if("string"==typeof t)return tt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(t,e):void 0}}function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach(function(e){rt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function rt(t,e,n){return(e=ot(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ot(r.key),r)}}function ot(t){var e=function(t){if("object"!=Y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:e+""}function at(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(at=function(){return!!t})()}function ct(t){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ct(t)}function ut(t,e){return ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ut(t,e)}var lt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ct(e),function(t,e){if(e&&("object"==Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,at()?Reflect.construct(e,n||[],ct(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ut(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=nt(nt({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?X(t.entities):[]}),this._config.entities=this._config.entities.map(function(t){return nt(nt({},t),{},{independent_display:!0===t.independent_display})}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加设备":"Add Device",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("light.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=X(n._config.entities);e[t]=nt(nt({},e[t]),{},{entity_id:o.value}),n._config=nt(nt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:nt({},n._config)}})),n.render()}),r.appendChild(o);var a=document.createElement("label");a.style.marginLeft="10px",a.style.display="inline-flex",a.style.alignItems="center",a.style.gap="6px";var c=document.createElement("input");c.type="checkbox",c.checked=!!e.independent_display;var u=document.createElement("span");u.textContent=this._translations[this._language].independentDisplay,a.appendChild(c),a.appendChild(u),r.appendChild(a),c.addEventListener("change",function(){var e=X(n._config.entities);e[t]=nt(nt({},e[t]),{},{independent_display:c.checked}),n._config=nt(nt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:nt({},n._config)}}))});var l=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=X(n._config.entities);e.splice(t,1),n._config=nt(nt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:nt({},n._config)}})),n.render()});return r.appendChild(l),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=X(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Z(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=nt(nt({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:nt({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=K().m(function t(){return K().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-light-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Q(i,n,r,a,c,"next",t)}function c(t){Q(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&it(n.prototype,r),i&&it(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function ft(t){return function(t){if(Array.isArray(t))return pt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return pt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dt(Object(n),!0).forEach(function(e){ht(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ht(t,e,n){return(e=bt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bt(r.key),r)}}function bt(t){var e=function(t){if("object"!=st(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=st(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==st(e)?e:e+""}function gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(gt=function(){return!!t})()}function mt(t){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mt(t)}function _t(t,e){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_t(t,e)}var Ot=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=mt(e),function(t,e){if(e&&("object"==st(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gt()?Reflect.construct(e,n||[],mt(t).constructor):e.apply(t,n))}(this,e))._translations={zh:yt(yt({},t._translations.zh),{},{speed:"速度",oscillate:"摆动",direction:"方向"}),en:yt(yt({},t._translations.en),{},{speed:"Speed",oscillate:"Oscillate",direction:"Direction"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=yt(yt({},t),{},{fan_name:t.fan_name||("zh"===this._language?"未命名风扇":"Unnamed Fan"),entities:Array.isArray(null==t?void 0:t.entities)?ft(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_fan.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.fan_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("fan.")){var r,i,o=document.createElement("div");o.style.marginBottom="12px",o.style.padding="8px",o.style.border="1px solid #ddd",o.style.borderRadius="4px";var a=t._hass.states[e.entity_id],c="on"===(null==a?void 0:a.state)?t._translations[t._language].stateOn:t._translations[t._language].stateOff;o.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - ").concat(c,"</div>");var u=t._createButton("on"===(null==a?void 0:a.state)?"Off":"On",function(){var n="on"===(null==a?void 0:a.state)?"turn_off":"turn_on";t._hass.callService("fan",n,{entity_id:e.entity_id})});if(o.appendChild(u),void 0!==(null==a||null===(r=a.attributes)||void 0===r?void 0:r.percentage)){var l=document.createElement("input");l.type="range",l.min="0",l.max="100",l.value=a.attributes.percentage||0,l.style.width="100%",l.style.marginTop="8px",l.addEventListener("change",function(n){t._hass.callService("fan","set_percentage",{entity_id:e.entity_id,percentage:parseInt(n.target.value)})}),o.appendChild(l)}if(void 0!==(null==a||null===(i=a.attributes)||void 0===i?void 0:i.oscillating)){var s=t._createButton(a.attributes.oscillating?"Stop Oscillate":"Start Oscillate",function(){t._hass.callService("fan","oscillate",{entity_id:e.entity_id,oscillating:!a.attributes.oscillating})});o.appendChild(s)}n.appendChild(o)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],r&&vt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function jt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Et(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Et(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Et(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Et(f,"constructor",l),Et(l,"constructor",u),u.displayName="GeneratorFunction",Et(l,i,"GeneratorFunction"),Et(f),Et(f,i,"Generator"),Et(f,r,function(){return this}),Et(f,"toString",function(){return"[object Generator]"}),(jt=function(){return{w:o,m:p}})()}function Et(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Et=function(t,e,n,r){function o(e,n){Et(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Et(t,e,n,r)}function St(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Pt(t){return function(t){if(Array.isArray(t))return Tt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ct(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,e){if(t){if("string"==typeof t)return Tt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tt(t,e):void 0}}function Tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach(function(e){kt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function kt(t,e,n){return(e=Rt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rt(r.key),r)}}function Rt(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}function Lt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Lt=function(){return!!t})()}function It(t){return It=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},It(t)}function Mt(t,e){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mt(t,e)}var Bt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=It(e),function(t,e){if(e&&("object"==wt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Lt()?Reflect.construct(e,n||[],It(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mt(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=At(At({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Pt(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加设备":"Add Device",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("fan.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Pt(n._config.entities);e[t]=At(At({},e[t]),{},{entity_id:o.value}),n._config=At(At({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:At({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Pt(n._config.entities);e.splice(t,1),n._config=At(At({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:At({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Pt(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Ct(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=At(At({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:At({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=jt().m(function t(){return jt().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-fan-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){St(i,n,r,a,c,"next",t)}function c(t){St(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Dt(n.prototype,r),i&&Dt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function zt(t){return function(t){if(Array.isArray(t))return Ht(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ht(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ht(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Gt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Wt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gt(Object(n),!0).forEach(function(e){Nt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Nt(t,e,n){return(e=$t(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$t(r.key),r)}}function $t(t){var e=function(t){if("object"!=Ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ut(e)?e:e+""}function Vt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Vt=function(){return!!t})()}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}function Yt(t,e){return Yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yt(t,e)}var Kt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=qt(e),function(t,e){if(e&&("object"==Ut(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Vt()?Reflect.construct(e,n||[],qt(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yt(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=Wt(Wt({},t),{},{scene_name:t.scene_name||("zh"===this._language?"未命名场景":"Unnamed Scene"),entities:Array.isArray(null==t?void 0:t.entities)?zt(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_scene.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.scene_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("scene.")){var r=document.createElement("div");r.style.marginBottom="8px";var i=t._createButton(e.scene_name||e.entity_id,function(){t._hass.callService("scene","turn_on",{entity_id:e.entity_id})});i.style.width="100%",i.style.padding="12px",r.appendChild(i),n.appendChild(r)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&Ft(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Qt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Xt(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Xt(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Xt(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Xt(f,"constructor",l),Xt(l,"constructor",u),u.displayName="GeneratorFunction",Xt(l,i,"GeneratorFunction"),Xt(f),Xt(f,i,"Generator"),Xt(f,r,function(){return this}),Xt(f,"toString",function(){return"[object Generator]"}),(Qt=function(){return{w:o,m:p}})()}function Xt(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Xt=function(t,e,n,r){function o(e,n){Xt(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Xt(t,e,n,r)}function Zt(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function te(t){return function(t){if(Array.isArray(t))return ne(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ee(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(t,e){if(t){if("string"==typeof t)return ne(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(t,e):void 0}}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(Object(n),!0).forEach(function(e){oe(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function oe(t,e,n){return(e=ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ce(r.key),r)}}function ce(t){var e=function(t){if("object"!=Jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jt(e)?e:e+""}function ue(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ue=function(){return!!t})()}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},se(t,e)}var fe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=le(e),function(t,e){if(e&&("object"==Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ue()?Reflect.construct(e,n||[],le(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=ie(ie({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?te(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加场景":"Add Scene",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("scene.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=te(n._config.entities);e[t]=ie(ie({},e[t]),{},{entity_id:o.value}),n._config=ie(ie({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ie({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=te(n._config.entities);e.splice(t,1),n._config=ie(ie({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ie({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=te(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||ee(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=ie(ie({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ie({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=Qt().m(function t(){return Qt().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-scene-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Zt(i,n,r,a,c,"next",t)}function c(t){Zt(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&ae(n.prototype,r),i&&ae(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function de(t){return function(t){if(Array.isArray(t))return ye(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ye(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function he(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?he(Object(n),!0).forEach(function(e){be(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function be(t,e,n){return(e=me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,me(r.key),r)}}function me(t){var e=function(t){if("object"!=pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pe(e)?e:e+""}function _e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_e=function(){return!!t})()}function Oe(t){return Oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oe(t)}function we(t,e){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},we(t,e)}var je=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Oe(e),function(t,e){if(e&&("object"==pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_e()?Reflect.construct(e,n||[],Oe(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&we(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=ve(ve({},t),{},{media_name:t.media_name||("zh"===this._language?"未命名播放器":"Unnamed Player"),entities:Array.isArray(null==t?void 0:t.entities)?de(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_media_play1.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.media_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("media_player.")){var r=t._hass.states[e.entity_id],i=document.createElement("div");i.style.marginBottom="12px",i.style.padding="8px",i.style.border="1px solid #ddd",i.style.borderRadius="4px",i.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - ").concat((null==r?void 0:r.state)||"unknown","</div>");var o=t._createButton("Play",function(){t._hass.callService("media_player","media_play",{entity_id:e.entity_id})}),a=t._createButton("Pause",function(){t._hass.callService("media_player","media_pause",{entity_id:e.entity_id})}),c=t._createButton("Stop",function(){t._hass.callService("media_player","media_stop",{entity_id:e.entity_id})});i.appendChild(o),i.appendChild(a),i.appendChild(c),n.appendChild(i)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&ge(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Ee(t){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(t)}function Se(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Pe(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Pe(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Pe(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Pe(f,"constructor",l),Pe(l,"constructor",u),u.displayName="GeneratorFunction",Pe(l,i,"GeneratorFunction"),Pe(f),Pe(f,i,"Generator"),Pe(f,r,function(){return this}),Pe(f,"toString",function(){return"[object Generator]"}),(Se=function(){return{w:o,m:p}})()}function Pe(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Pe=function(t,e,n,r){function o(e,n){Pe(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Pe(t,e,n,r)}function Ce(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Te(t){return function(t){if(Array.isArray(t))return Ae(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||xe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(t,e){if(t){if("string"==typeof t)return Ae(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(t,e):void 0}}function Ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function De(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(n),!0).forEach(function(e){Re(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Re(t,e,n){return(e=Ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ie(r.key),r)}}function Ie(t){var e=function(t){if("object"!=Ee(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ee(e)?e:e+""}function Me(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Me=function(){return!!t})()}function Be(t){return Be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Be(t)}function Ue(t,e){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ue(t,e)}var ze=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Be(e),function(t,e){if(e&&("object"==Ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Me()?Reflect.construct(e,n||[],Be(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=De(De({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Te(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加播放器":"Add Media Player",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("media_player.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Te(n._config.entities);e[t]=De(De({},e[t]),{},{entity_id:o.value}),n._config=De(De({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:De({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Te(n._config.entities);e.splice(t,1),n._config=De(De({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:De({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Te(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||xe(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=De(De({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:De({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=Se().m(function t(){return Se().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-media-player-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Ce(i,n,r,a,c,"next",t)}function c(t){Ce(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Le(n.prototype,r),i&&Le(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function Ge(t){return function(t){if(Array.isArray(t))return We(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return We(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach(function(e){$e(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function $e(t,e,n){return(e=qe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qe(r.key),r)}}function qe(t){var e=function(t){if("object"!=He(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==He(e)?e:e+""}function Ye(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ye=function(){return!!t})()}function Ke(t){return Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ke(t)}function Je(t,e){return Je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Je(t,e)}var Qe=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Ke(e),function(t,e){if(e&&("object"==He(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ye()?Reflect.construct(e,n||[],Ke(t).constructor):e.apply(t,n))}(this,e))._translations={zh:Fe(Fe({},t._translations.zh),{},{temperature:"温度",humidity:"湿度",mode:"模式"}),en:Fe(Fe({},t._translations.en),{},{temperature:"Temperature",humidity:"Humidity",mode:"Mode"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Je(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=Fe(Fe({},t),{},{climate_name:t.climate_name||("zh"===this._language?"未命名空调":"Unnamed AC"),entities:Array.isArray(null==t?void 0:t.entities)?Ge(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_climate.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.climate_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("climate.")){var r,i,o=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==o||null===(r=o.attributes)||void 0===r?void 0:r.current_temperature)||"--",u=(null==o||null===(i=o.attributes)||void 0===i?void 0:i.temperature)||"--";a.innerHTML='\n            <div style="margin-bottom: 8px;">\n              <strong>'.concat(e.entity_id,"</strong><br/>\n              ").concat(t._translations[t._language].temperature,": ").concat(c,"°C → ").concat(u,"°C\n            </div>\n          ");var l=t._createButton("On",function(){t._hass.callService("climate","turn_on",{entity_id:e.entity_id})}),s=t._createButton("Off",function(){t._hass.callService("climate","turn_off",{entity_id:e.entity_id})});a.appendChild(l),a.appendChild(s),n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&Ve(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function Ze(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return tn(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(tn(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,tn(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,tn(f,"constructor",l),tn(l,"constructor",u),u.displayName="GeneratorFunction",tn(l,i,"GeneratorFunction"),tn(f),tn(f,i,"Generator"),tn(f,r,function(){return this}),tn(f,"toString",function(){return"[object Generator]"}),(Ze=function(){return{w:o,m:p}})()}function tn(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}tn=function(t,e,n,r){function o(e,n){tn(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},tn(t,e,n,r)}function en(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function nn(t){return function(t){if(Array.isArray(t))return on(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||rn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(t,e){if(t){if("string"==typeof t)return on(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?on(t,e):void 0}}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function an(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function cn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?an(Object(n),!0).forEach(function(e){un(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):an(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function un(t,e,n){return(e=sn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,sn(r.key),r)}}function sn(t){var e=function(t){if("object"!=Xe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xe(e)?e:e+""}function fn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fn=function(){return!!t})()}function pn(t){return pn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pn(t)}function dn(t,e){return dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},dn(t,e)}var yn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=pn(e),function(t,e){if(e&&("object"==Xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fn()?Reflect.construct(e,n||[],pn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=cn(cn({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?nn(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加空调":"Add Climate",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("climate.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=nn(n._config.entities);e[t]=cn(cn({},e[t]),{},{entity_id:o.value}),n._config=cn(cn({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:cn({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=nn(n._config.entities);e.splice(t,1),n._config=cn(cn({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:cn({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=nn(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||rn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=cn(cn({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:cn({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=Ze().m(function t(){return Ze().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-climate-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){en(i,n,r,a,c,"next",t)}function c(t){en(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&ln(n.prototype,r),i&&ln(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function vn(t){return function(t){if(Array.isArray(t))return bn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return bn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function gn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function mn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gn(Object(n),!0).forEach(function(e){_n(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _n(t,e,n){return(e=wn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wn(r.key),r)}}function wn(t){var e=function(t){if("object"!=hn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==hn(e)?e:e+""}function jn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(jn=function(){return!!t})()}function En(t){return En=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},En(t)}function Sn(t,e){return Sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sn(t,e)}var Pn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=En(e),function(t,e){if(e&&("object"==hn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jn()?Reflect.construct(e,n||[],En(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=mn(mn({},t),{},{cover_name:t.cover_name||("zh"===this._language?"未命名窗帘":"Unnamed Cover"),entities:Array.isArray(null==t?void 0:t.entities)?vn(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_cover.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.cover_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("cover.")){var r,i,o=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==o||null===(r=o.attributes)||void 0===r?void 0:r.current_position)||0;a.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - Position: ").concat(c,"%</div>");var u=t._createButton("Open",function(){t._hass.callService("cover","open_cover",{entity_id:e.entity_id})}),l=t._createButton("Close",function(){t._hass.callService("cover","close_cover",{entity_id:e.entity_id})}),s=t._createButton("Stop",function(){t._hass.callService("cover","stop_cover",{entity_id:e.entity_id})});if(a.appendChild(u),a.appendChild(l),a.appendChild(s),void 0!==(null==o||null===(i=o.attributes)||void 0===i?void 0:i.current_position)){var f=document.createElement("input");f.type="range",f.min="0",f.max="100",f.value=c,f.style.width="100%",f.style.marginTop="8px",f.addEventListener("change",function(n){t._hass.callService("cover","set_cover_position",{entity_id:e.entity_id,position:parseInt(n.target.value)})}),a.appendChild(f)}n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],r&&On(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Cn(t){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cn(t)}function Tn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return xn(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(xn(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,xn(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,xn(f,"constructor",l),xn(l,"constructor",u),u.displayName="GeneratorFunction",xn(l,i,"GeneratorFunction"),xn(f),xn(f,i,"Generator"),xn(f,r,function(){return this}),xn(f,"toString",function(){return"[object Generator]"}),(Tn=function(){return{w:o,m:p}})()}function xn(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}xn=function(t,e,n,r){function o(e,n){xn(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},xn(t,e,n,r)}function An(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function kn(t){return function(t){if(Array.isArray(t))return Rn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Dn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dn(t,e){if(t){if("string"==typeof t)return Rn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rn(t,e):void 0}}function Rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ln(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function In(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ln(Object(n),!0).forEach(function(e){Mn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Mn(t,e,n){return(e=Un(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Un(r.key),r)}}function Un(t){var e=function(t){if("object"!=Cn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Cn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Cn(e)?e:e+""}function zn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(zn=function(){return!!t})()}function Hn(t){return Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hn(t)}function Gn(t,e){return Gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gn(t,e)}var Wn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Hn(e),function(t,e){if(e&&("object"==Cn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zn()?Reflect.construct(e,n||[],Hn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=In(In({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?kn(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加窗帘":"Add Cover",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("cover.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=kn(n._config.entities);e[t]=In(In({},e[t]),{},{entity_id:o.value}),n._config=In(In({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:In({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=kn(n._config.entities);e.splice(t,1),n._config=In(In({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:In({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=kn(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Dn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=In(In({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:In({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=Tn().m(function t(){return Tn().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-cover-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){An(i,n,r,a,c,"next",t)}function c(t){An(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Bn(n.prototype,r),i&&Bn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function Fn(t){return function(t){if(Array.isArray(t))return $n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $n(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Vn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function qn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vn(Object(n),!0).forEach(function(e){Yn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Yn(t,e,n){return(e=Jn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jn(r.key),r)}}function Jn(t){var e=function(t){if("object"!=Nn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nn(e)?e:e+""}function Qn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Qn=function(){return!!t})()}function Xn(t){return Xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xn(t)}function Zn(t,e){return Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zn(t,e)}var tr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Xn(e),function(t,e){if(e&&("object"==Nn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qn()?Reflect.construct(e,n||[],Xn(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zn(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=qn(qn({},t),{},{switch_name:t.switch_name||("zh"===this._language?"未命名开关":"Unnamed Switch"),entities:Array.isArray(null==t?void 0:t.entities)?Fn(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_switch.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.switch_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("switch.")){var r=t._hass.states[e.entity_id],i=document.createElement("div");i.style.marginBottom="8px";var o="on"===(null==r?void 0:r.state)?t._translations[t._language].stateOn:t._translations[t._language].stateOff,a=t._createButton("".concat(e.entity_id,": ").concat(o),function(){var n="on"===(null==r?void 0:r.state)?"turn_off":"turn_on";t._hass.callService("switch",n,{entity_id:e.entity_id})});a.style.width="100%",a.style.padding="12px",i.appendChild(a),n.appendChild(i)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&Kn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function nr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return rr(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(rr(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,rr(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,rr(f,"constructor",l),rr(l,"constructor",u),u.displayName="GeneratorFunction",rr(l,i,"GeneratorFunction"),rr(f),rr(f,i,"Generator"),rr(f,r,function(){return this}),rr(f,"toString",function(){return"[object Generator]"}),(nr=function(){return{w:o,m:p}})()}function rr(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}rr=function(t,e,n,r){function o(e,n){rr(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},rr(t,e,n,r)}function ir(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function or(t){return function(t){if(Array.isArray(t))return cr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ar(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(t,e){if(t){if("string"==typeof t)return cr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cr(t,e):void 0}}function cr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ur(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function lr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ur(Object(n),!0).forEach(function(e){sr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ur(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function sr(t,e,n){return(e=pr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pr(r.key),r)}}function pr(t){var e=function(t){if("object"!=er(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==er(e)?e:e+""}function dr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(dr=function(){return!!t})()}function yr(t){return yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yr(t)}function hr(t,e){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hr(t,e)}var vr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=yr(e),function(t,e){if(e&&("object"==er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dr()?Reflect.construct(e,n||[],yr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=lr(lr({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?or(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加开关":"Add Switch",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("switch.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=or(n._config.entities);e[t]=lr(lr({},e[t]),{},{entity_id:o.value}),n._config=lr(lr({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:lr({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=or(n._config.entities);e.splice(t,1),n._config=lr(lr({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:lr({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=or(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||ar(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=lr(lr({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:lr({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=nr().m(function t(){return nr().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-switch-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){ir(i,n,r,a,c,"next",t)}function c(t){ir(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&fr(n.prototype,r),i&&fr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function br(t){return br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},br(t)}function gr(t){return function(t){if(Array.isArray(t))return mr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return mr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Or(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_r(Object(n),!0).forEach(function(e){wr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function wr(t,e,n){return(e=Er(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Er(r.key),r)}}function Er(t){var e=function(t){if("object"!=br(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=br(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==br(e)?e:e+""}function Sr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Sr=function(){return!!t})()}function Pr(t){return Pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pr(t)}function Cr(t,e){return Cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Cr(t,e)}var Tr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Pr(e),function(t,e){if(e&&("object"==br(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Sr()?Reflect.construct(e,n||[],Pr(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cr(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=Or(Or({},t),{},{weather_name:t.weather_name||("zh"===this._language?"未命名天气":"Unnamed Weather"),entities:Array.isArray(null==t?void 0:t.entities)?gr(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_weather.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.weather_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("weather.")){var r,i,o=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==o||null===(r=o.attributes)||void 0===r?void 0:r.temperature)||"--",u=(null==o||null===(i=o.attributes)||void 0===i?void 0:i.humidity)||"--",l=(null==o?void 0:o.state)||"unknown";a.innerHTML='\n            <div style="margin-bottom: 8px;">\n              <strong>'.concat(e.entity_id,"</strong><br/>\n              状况: ").concat(l,"<br/>\n              温度: ").concat(c,"°C<br/>\n              湿度: ").concat(u,"%\n            </div>\n          "),n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&jr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function xr(t){return xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xr(t)}function Ar(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return kr(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(kr(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,kr(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,kr(f,"constructor",l),kr(l,"constructor",u),u.displayName="GeneratorFunction",kr(l,i,"GeneratorFunction"),kr(f),kr(f,i,"Generator"),kr(f,r,function(){return this}),kr(f,"toString",function(){return"[object Generator]"}),(Ar=function(){return{w:o,m:p}})()}function kr(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}kr=function(t,e,n,r){function o(e,n){kr(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},kr(t,e,n,r)}function Dr(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Rr(t){return function(t){if(Array.isArray(t))return Ir(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Lr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(t,e){if(t){if("string"==typeof t)return Ir(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ir(t,e):void 0}}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Mr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Br(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mr(Object(n),!0).forEach(function(e){Ur(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ur(t,e,n){return(e=Hr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hr(r.key),r)}}function Hr(t){var e=function(t){if("object"!=xr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=xr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xr(e)?e:e+""}function Gr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Gr=function(){return!!t})()}function Wr(t){return Wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wr(t)}function Nr(t,e){return Nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nr(t,e)}var Fr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Wr(e),function(t,e){if(e&&("object"==xr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Gr()?Reflect.construct(e,n||[],Wr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Br(Br({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Rr(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加天气":"Add Weather",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("weather.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Rr(n._config.entities);e[t]=Br(Br({},e[t]),{},{entity_id:o.value}),n._config=Br(Br({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Br({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Rr(n._config.entities);e.splice(t,1),n._config=Br(Br({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Br({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Rr(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Lr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=Br(Br({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Br({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=Ar().m(function t(){return Ar().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-weather-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Dr(i,n,r,a,c,"next",t)}function c(t){Dr(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&zr(n.prototype,r),i&&zr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function $r(t){return $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$r(t)}function Vr(t){return function(t){if(Array.isArray(t))return qr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return qr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Yr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Kr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yr(Object(n),!0).forEach(function(e){Jr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Jr(t,e,n){return(e=Xr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xr(r.key),r)}}function Xr(t){var e=function(t){if("object"!=$r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$r(e)?e:e+""}function Zr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Zr=function(){return!!t})()}function ti(t){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ti(t)}function ei(t,e){return ei=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ei(t,e)}var ni=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=ti(e),function(t,e){if(e&&("object"==$r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zr()?Reflect.construct(e,n||[],ti(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ei(t,e)}(e,t),n=e,(r=[{key:"setConfig",value:function(t){this._config=Kr(Kr({},t),{},{host_name:t.host_name||("zh"===this._language?"未命名主机":"Unnamed Host"),entities:Array.isArray(null==t?void 0:t.entities)?Vr(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_host.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.host_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("remote.")){t._hass.states[e.entity_id];var r=document.createElement("div");r.style.marginBottom="12px",r.style.padding="8px",r.style.border="1px solid #ddd",r.style.borderRadius="4px",r.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong></div>"),(e.commands||[]).forEach(function(n){var i=t._createButton(n.label||n,function(){t._hass.callService("remote","send_command",{entity_id:e.entity_id,command:n.value||n})});r.appendChild(i)}),n.appendChild(r)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}])&&Qr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function ii(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return oi(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(oi(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,oi(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,oi(f,"constructor",l),oi(l,"constructor",u),u.displayName="GeneratorFunction",oi(l,i,"GeneratorFunction"),oi(f),oi(f,i,"Generator"),oi(f,r,function(){return this}),oi(f,"toString",function(){return"[object Generator]"}),(ii=function(){return{w:o,m:p}})()}function oi(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}oi=function(t,e,n,r){function o(e,n){oi(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},oi(t,e,n,r)}function ai(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function ci(t){return function(t){if(Array.isArray(t))return li(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ui(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ui(t,e){if(t){if("string"==typeof t)return li(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?li(t,e):void 0}}function li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function si(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function fi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?si(Object(n),!0).forEach(function(e){pi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):si(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function pi(t,e,n){return(e=yi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yi(r.key),r)}}function yi(t){var e=function(t){if("object"!=ri(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ri(e)?e:e+""}function hi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(hi=function(){return!!t})()}function vi(t){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vi(t)}function bi(t,e){return bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bi(t,e)}var gi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=vi(e),function(t,e){if(e&&("object"==ri(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,hi()?Reflect.construct(e,n||[],vi(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bi(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=fi(fi({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?ci(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加主机":"Add Host",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("remote.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=ci(n._config.entities);e[t]=fi(fi({},e[t]),{},{entity_id:o.value}),n._config=fi(fi({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:fi({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=ci(n._config.entities);e.splice(t,1),n._config=fi(fi({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:fi({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=ci(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||ui(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=fi(fi({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:fi({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],i=[{key:"getConfigElement",value:(o=ii().m(function t(){return ii().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-host-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){ai(i,n,r,a,c,"next",t)}function c(t){ai(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&di(n.prototype,r),i&&di(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);customElements.define("aiks-tv-card",O),customElements.define("aiks-tv-card-editor",M),customElements.define("aiks-light-card",q),customElements.define("aiks-light-card-editor",lt),customElements.define("aiks-fan-card",Ot),customElements.define("aiks-fan-card-editor",Bt),customElements.define("aiks-scene-card",Kt),customElements.define("aiks-scene-card-editor",fe),customElements.define("aiks-media-player-card",je),customElements.define("aiks-media-player-card-editor",ze),customElements.define("aiks-climate-card",Qe),customElements.define("aiks-climate-card-editor",yn),customElements.define("aiks-cover-card",Pn),customElements.define("aiks-cover-card-editor",Wn),customElements.define("aiks-switch-card",tr),customElements.define("aiks-switch-card-editor",vr),customElements.define("aiks-weather-card",Tr),customElements.define("aiks-weather-card-editor",Fr),customElements.define("aiks-host-card",ni),customElements.define("aiks-host-card-editor",gi),window.customCards=window.customCards||[],window.customCards.push({type:"aiks-tv-card",name:navigator.language.startsWith("zh")?"电视(ROS)":"TV(ROS)",description:navigator.language.startsWith("zh")?"电视卡片":"TV Card",preview:!0},{type:"aiks-light-card",name:navigator.language.startsWith("zh")?"灯光(ROS)":"Light(ROS)",description:navigator.language.startsWith("zh")?"灯光卡片":"Light Card",preview:!0},{type:"aiks-fan-card",name:navigator.language.startsWith("zh")?"风扇(ROS)":"Fan(ROS)",description:navigator.language.startsWith("zh")?"风扇卡片":"Fan Card",preview:!0},{type:"aiks-scene-card",name:navigator.language.startsWith("zh")?"场景(ROS)":"Scene(ROS)",description:navigator.language.startsWith("zh")?"场景卡片":"Scene Card",preview:!0},{type:"aiks-media-player-card",name:navigator.language.startsWith("zh")?"媒体播放器(ROS)":"Media Player(ROS)",description:navigator.language.startsWith("zh")?"媒体播放器卡片":"Media Player Card",preview:!0},{type:"aiks-climate-card",name:navigator.language.startsWith("zh")?"空调(ROS)":"AC(ROS)",description:navigator.language.startsWith("zh")?"空调卡片":"AC Card",preview:!0},{type:"aiks-cover-card",name:navigator.language.startsWith("zh")?"窗帘(ROS)":"Cover(ROS)",description:navigator.language.startsWith("zh")?"窗帘卡片":"Cover Card",preview:!0},{type:"aiks-switch-card",name:navigator.language.startsWith("zh")?"开关(ROS)":"Switch(ROS)",description:navigator.language.startsWith("zh")?"开关卡片":"Switch Card",preview:!0},{type:"aiks-weather-card",name:navigator.language.startsWith("zh")?"天气(ROS)":"Weather(ROS)",description:navigator.language.startsWith("zh")?"天气卡片":"Weather Card",preview:!0},{type:"aiks-host-card",name:navigator.language.startsWith("zh")?"主机(ROS)":"Host(ROS)",description:navigator.language.startsWith("zh")?"主机卡片":"Host Card",preview:!0}),console.log("✅ Aiks Custom Cards loaded successfully!")})();
//# sourceMappingURL=RosCard.js.map1